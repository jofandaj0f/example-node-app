var request=require("request"),logger=require("./logger"),enps={logon:function(e,t,n,o,r){var a={method:"GET",url:e+"/api/Logon",qs:{staffUserId:t,domainuserId:"enpsapi",password:n,domainName:o,devKey:r,iClientType:"7"},headers:{"Cache-Control":"no-cache"}};return new Promise(function(e,t){request.get(a,function(n,o,r){n?t(n):e(JSON.parse(r))})})},ping:function(e,t){request({method:"GET",url:e+"/api/Ping",headers:{"Cache-Control":"no-cache","X-ENPS-TOKEN":t}},function(e,t,n){if(e)throw new Error(e);console.log(n)})},search:function(e,t,n,o){logger.info("enps.js search: ",e,t,n,o);var r={method:"POST",url:e+"/api/Search",headers:{"Content-Type":"application/json","X-ENPS-TOKEN":t},body:{Database:n,MaxRows:200,ExactMatch:!1,NOMContentTypes:{All:!1,Audio:!1,Contacts:!1,Grids:!1,Messages:!1,NewsgatheringGrids:!1,NewsgatheringItems:!1,Pictures:!1,Readins:!1,Rundowns:!0,Scripts:!1,Storyboards:!1,Video:!1},NOMContentDates:{All:!0,CustomDateRange:!1,FortyEightHours:!1,ItemDateFrom:"2018-10-02T00:00:01.000Z",ItemDateTo:"2018-10-02T23:59:00.000Z",Future:!1,OneHour:!1,OneWeek:!1,TwentyFourHours:!1,TwoHours:!1},NOMLocations:[{BasePath:o,SearchArchives:!1,SearchTrash:!1,SearchWIP:!0}]},json:!0};return new Promise(function(e,t){request.post(r,function(n,o,r){if(n)t(n);else{for(var a=[],s=0;s<r.SearchResults.length;s++){var i=r.SearchResults[s];if(i.ObjectProperties[10].FieldValue){var u={database:i.ListData.ENPSDatabase,path:i.ListData.Path,guid:i.ListData.Guid,returnText:!1};a.push(u)}}e(a)}})})},getMultiplePlanningContent:function(e,t,n){void 0!==n&&null!==n&&0!==n.length||logger.info("UNDEFINED OBJECT PLACED INTO FUNCTION");var o={method:"POST",url:e+"/api/RundownContent",headers:{"Content-Type":"application/json","X-ENPS-TOKEN":t},body:n,json:!0};return new Promise(function(e,t){request.post(o,function(n,o,r){n?t(n):e(r)})})}};module.exports=enps;